# 🤖 بوت مراقبة الأخبار والنشر التلقائي

بوت ذكي لمراقبة المواقع الإخبارية ونشر المحتوى تلقائياً على Telegram مع دعم كامل للغة العربية.

## ✨ **المميزات الرئيسية**

- � **مراقبة تلقائية** للمواقع الإخبارية
- 🚀 **نشر فوري** للمحتوى الجديد
- 📝 **صفحات Telegraph** للمقالات الطويلة
- 🖼️ **دعم الصور** والوسائط المتعددة
- 👥 **نظام موافقة** المديرين
- 🔧 **إعدادات قابلة للتخصيص**
- 🌐 **دعم كامل للغة العربية**

## 🚀 **بدء سريع**

### 1. إعداد البوت
```bash
# اختبار البوت token
python3 test_bot_token.py

# إعداد ملف .env تلقائياً
python3 setup_env.py

# تشغيل البوت
python3 main.py
```

### 2. متطلبات النظام
```bash
# تثبيت المكتبات المطلوبة
pip3 install -r requirements.txt
```

## ❌ **حل مشكلة البوت Token**

### المشكلة الشائعة:
```
ERROR: The token was rejected by the server.
HTTP/1.1 401 Unauthorized
```

### 🔧 **الحل الفوري:**

1. **اختبار البوت token:**
   ```bash
   python3 test_bot_token.py
   ```

2. **إنشاء بوت جديد:**
   - اذهب إلى [@BotFather](https://t.me/BotFather)
   - أرسل `/newbot`
   - اتبع التعليمات للحصول على token جديد

3. **تحديث الإعدادات:**
   ```bash
   python3 setup_env.py
   ```

4. **تشغيل البوت:**
   ```bash
   python3 main.py
   ```

## 📋 **الإعدادات المطلوبة**

### ملف `.env` الأساسي:
```env
# إعدادات البوت
BOT_TOKEN=your_bot_token_here
CHAT_ID=your_chat_id_here
ADMIN_IDS=[your_admin_id_here]

# إعدادات الموقع
WEBSITE_URL=https://www.ansarollah.com.ye
AUTO_PUBLISH=true
CHECK_INTERVAL=120

# إعدادات قاعدة البيانات
DATABASE_PATH=data/ansarollah_bot.db
```

## 🛠️ **أدوات المساعدة**

| الأداة | الوصف | الاستخدام |
|--------|--------|----------|
| `test_bot_token.py` | اختبار صحة البوت token | `python3 test_bot_token.py` |
| `setup_env.py` | إعداد ملف .env تلقائياً | `python3 setup_env.py` |
| `main.py` | تشغيل البوت الرئيسي | `python3 main.py` |

## 🔍 **تشخيص المشاكل**

### 1. مشكلة البوت Token:
```bash
# اختبار البوت
python3 test_bot_token.py

# إذا فشل الاختبار، أنشئ بوت جديد
python3 setup_env.py
```

### 2. مشكلة الإعدادات:
```bash
# فحص الإعدادات الحالية
python3 -c "from config import Config; Config.print_config()"
```

### 3. مشكلة الاتصال:
```bash
# اختبار الاتصال بالإنترنت
curl -I https://api.telegram.org

# اختبار الاتصال بالموقع
curl -I https://www.ansarollah.com.ye
```

## 📊 **حالة النظام**

### ✅ **المشاكل المحلولة:**
- ✅ **Event Loop Issues** - تم حل جميع مشاكل "Cannot close a running event loop"
- ✅ **RuntimeWarning** - لا توجد تحذيرات حول coroutines
- ✅ **Bot Token Validation** - تحقق تلقائي من صحة البوت token
- ✅ **Graceful Shutdown** - إيقاف نظيف للبوت
- ✅ **Error Handling** - معالجة شاملة للأخطاء

### 🔧 **الميزات المتقدمة:**
- 🤖 **واجهة سهلة** لإعداد البوت
- 🔍 **تشخيص تلقائي** للمشاكل
- 📋 **تسجيل مفصل** للأحداث
- 🛡️ **أمان محسن** للبيانات

## 🎯 **أوامر البوت**

| الأمر | الوصف |
|-------|--------|
| `/start` | بدء البوت |
| `/help` | قائمة المساعدة |
| `/status` | حالة البوت |
| `/pending` | المقالات المعلقة |
| `/settings` | إعدادات البوت |
| `/test` | اختبار النظام |

## � **الأمان**

### نصائح الأمان:
1. **لا تشارك البوت token** مع أحد
2. **تأكد من ملف .env** غير مرفوع على GitHub
3. **استخدم متغيرات البيئة** في الإنتاج
4. **قم بتحديث البوت** بانتظام

### إعداد الأمان:
```bash
# إخفاء ملف .env من git
echo ".env" >> .gitignore

# تعيين صلاحيات محدودة
chmod 600 .env
```

## 🆘 **الحصول على المساعدة**

### خطوات الحل السريع:
1. 🔍 **اختبار البوت:** `python3 test_bot_token.py`
2. 🔧 **إعداد جديد:** `python3 setup_env.py`
3. 🚀 **تشغيل البوت:** `python3 main.py`

### المشاكل الشائعة:
- **❌ Token غير صحيح:** استخدم `python3 setup_env.py`
- **❌ Chat ID خاطئ:** تحقق من الرقم في ملف .env
- **❌ لا يعمل البوت:** تأكد من صحة جميع الإعدادات

## � **الملاحظات**

- 🎯 **تم حل جميع مشاكل Event Loop** - البوت يعمل بشكل مستقر
- � **أدوات تشخيص متقدمة** - لحل المشاكل بسرعة
- � **توثيق شامل** - لجميع الإعدادات والأوامر
- 🚀 **جاهز للإنتاج** - مع استقرار كامل

---

**🎉 البوت جاهز للعمل!** استخدم الأدوات المتوفرة للإعداد السريع والتشخيص الفوري للمشاكل.